<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>评价列表</title>
    <link rel="stylesheet" href="../lib/layui-v2.6.3/css/layui.css">
    <style>
        body { margin: 0; padding: 0; background-color: #f5f6f8; }
        .header { height: 50px; line-height: 50px; background: #2f4050; color: #fff; padding: 0 20px; }
        .header-title { float: left; font-weight: 600; }
        .header-operate { float: right; }
        .header-btn { margin-left: 15px; cursor: pointer; }
        .main { padding: 20px; }
        .card { background: #fff; border-radius: 4px; padding: 20px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .stat { display: flex; gap: 15px; margin-bottom: 20px; }
        .stat-item { flex: 1; padding: 15px; background: #f9f9f9; border-radius: 4px; text-align: center; }
        .stat-value { font-size: 24px; color: #1E9FFF; margin: 5px 0; }
        .stat-warning .stat-value { color: #FF5722; }
        .filter { padding: 15px; background: #f9f9f9; border-radius: 4px; margin-bottom: 20px; }
        .star { color: #FFD700; }
        .star-empty { color: #ddd; }
        .status { padding: 2px 8px; border-radius: 4px; font-size: 12px; }
        .status-normal { background: #d4edda; color: #155724; }
        .status-violated { background: #f8d7da; color: #721c24; }
        .img-item { width: 30px; height: 30px; display: inline-block; margin: 0 2px; }
        .img-item img { width: 100%; height: 100%; object-fit: cover; }
        .empty { text-align: center; padding: 60px 0; color: #999; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-title">评价管理 - 评价列表</div>
        <div class="header-operate">
            <span class="header-btn" id="refresh"><i class="layui-icon layui-icon-refresh"></i></span>
        </div>
    </div>

    <div class="main">
        <div class="card">
            <!-- 数据统计 -->
            <div class="stat">
                <div class="stat-item">
                    <div>本月新增评价</div>
                    <div class="stat-value">128</div>
                </div>
                <div class="stat-item">
                    <div>5星评价占比</div>
                    <div class="stat-value">78%</div>
                </div>
                <div class="stat-item stat-warning">
                    <div>待处理违规</div>
                    <div class="stat-value">3</div>
                </div>
            </div>

            <!-- 筛选区 -->
            <div class="filter">
                <form class="layui-form" lay-filter="filter">
                    <div class="layui-form-item">
                        <div class="layui-input-inline" style="width: 150px;">
                            <input type="text" name="reviewId" placeholder="评价ID" class="layui-input">
                        </div>
                        <div class="layui-input-inline" style="width: 150px;">
                            <input type="text" name="tradeId" placeholder="交易ID" class="layui-input">
                        </div>
                        <div class="layui-input-inline" style="width: 120px;">
                            <select name="star">
                                <option value="">全部星级</option>
                                <option value="5">5星</option>
                                <option value="4">4星</option>
                                <option value="3">3星</option>
                                <option value="2">2星</option>
                                <option value="1">1星</option>
                            </select>
                        </div>
                        <div class="layui-input-inline" style="width: 120px;">
                            <select name="status">
                                <option value="">全部状态</option>
                                <option value="normal">正常</option>
                                <option value="violated">违规</option>
                            </select>
                        </div>
                        <button class="layui-btn" lay-submit lay-filter="search">查询</button>
                        <button type="button" class="layui-btn layui-btn-primary" id="clear">清空</button>
                    </div>
                </form>
            </div>

            <!-- 列表区 -->
            <table class="layui-table" lay-size="sm">
                <thead>
                    <tr>
                        <th>评价ID</th>
                        <th>交易ID</th>
                        <th>评价人</th>
                        <th>被评价人</th>
                        <th>星级</th>
                        <th>内容</th>
                        <th>时间</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="list">
                    <tr><td colspan="9" class="empty"><i class="layui-icon layui-icon-star" style="font-size:48px;"></i><p>暂无数据</p></td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <script src="../lib/layui-v2.6.3/layui.js"></script>
    <script>
        layui.use(['form', 'layer', 'jquery'], function() {
            const $ = layui.jquery, form = layui.form, layer = layui.layer;

            // 刷新页面
            $('#refresh').click(() => location.reload());
            
            // 清空筛选
            $('#clear').click(() => {
                $('form')[0].reset();
                form.render();
            });

            // 渲染星级
            const renderStar = (star) => {
                let html = '';
                for (let i = 1; i <= 5; i++) {
                    html += i <= star ? 
                        '<i class="layui-icon layui-icon-star star"></i>' : 
                        '<i class="layui-icon layui-icon-star star-empty"></i>';
                }
                return html;
            };

            // 渲染图片
            const renderImg = (imgs) => {
                return imgs.map(img => `<div class="img-item"><img src="${img}"></div>`).join('');
            };

            // 查询评价
            form.on('submit(search)', function(data) {
                $('#list').html('<tr><td colspan="9" class="empty"><i class="layui-icon layui-icon-loading"></i><p>加载中...</p></td></tr>');
                
                // 模拟数据
                setTimeout(() => {
                    const data = [
                        {id: 'REV20240926001', tradeId: 'TRA20240920001', 
                         reviewer: '2024001(张三)', reviewed: '2023056(李四)',
                         star: 5, content: '商品质量很好，发货快',
                         imgs: ['https://picsum.photos/id/11/200/200'], 
                         time: '2025-08-26', status: 'normal'},
                        {id: 'REV20240925003', tradeId: 'TRA20240919005',
                         reviewer: '2023078(大明)', reviewed: '2023066(小红)',
                         star: 3, content: '商品不错，送货稍晚',
                         imgs: [], time: '2025-08-25', status: 'normal'},
                        {id: 'REV20240924002', tradeId: 'TRA20240918012',
                         reviewer: '2024010(王五)', reviewed: '2024008(赵六)',
                         star: 1, content: '商品有破损，态度差',
                         imgs: ['https://picsum.photos/id/21/200/200'], 
                         time: '2025-08-24', status: 'violated'}
                    ];

                    let html = '';
                    data.forEach(item => {
                        const statusClass = item.status === 'normal' ? 'status-normal' : 'status-violated';
                        const statusText = item.status === 'normal' ? '正常' : '违规';
                        
                        html += `<tr>
                            <td>${item.id}</td>
                            <td>${item.tradeId}</td>
                            <td>${item.reviewer}</td>
                            <td>${item.reviewed}</td>
                            <td>${renderStar(item.star)}</td>
                            <td>${item.content}${renderImg(item.imgs)}</td>
                            <td>${item.time}</td>
                            <td><span class="status ${statusClass}">${statusText}</span></td>
                            <td>
                                <a href="reply.html?id=${item.id}" class="layui-btn layui-btn-xs">回复</a>
                                <a href="violate.html?id=${item.id}" class="layui-btn layui-btn-xs layui-btn-warning">处理</a>
                            </td>
                        </tr>`;
                    });
                    $('#list').html(html);
                }, 600);
                
                return false;
            });

            // 初始加载
            setTimeout(() => form.onSubmit('search')(), 300);
        });
    </script>
</body>
</html>
    
